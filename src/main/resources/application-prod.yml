spring:
  datasource:
    url: ${DB_URL}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
  jpa:
    hibernate:
      ddl-auto: none
      # database-platform: org.hibernate.dialect.MariaDBDialect
      naming:
        physical-strategy: io.hypersistence.utils.hibernate.naming.CamelCaseToSnakeCaseNamingStrategy
    # show-sql: true
  flyway:
    # Enable Flyway
    enabled: true
    baseline-on-migrate: false
    validate-on-migrate: true
    clean-disabled: true
  mvc:
    # Disable RFC 7807 Problem Details format to use custom error responses
    problemdetails:
      enabled: false
    # Throw exceptions instead of sending to /error for 404
  main:
    # Allow bean overriding for locale resolver customization
    allow-bean-definition-overriding: true
  web:
    resources:
      add-mappings: false

logging:
  level:
    "[org.springframework.web.filter.CommonsRequestLoggingFilter]": DEBUG
    root: INFO
    org:
      flywaydb: DEBUG

# HTTP server configuration (SSL handled by nginx reverse proxy)
server:
  port: 8080
  ssl:
    enabled: false
  servlet:
    context-path: /api
    session:
      cookie:
        # Session cookie settings (secure=false since nginx handles SSL termination)
        http-only: true
        secure: false
  error:
    # Disable default error page
    whitelabel:
      enabled: false
    # Include exception details in error responses
    include-message: always
    include-exception: false
    include-stacktrace: never

trackdev:
  cors:
    allowed-origin: ${CORS_ALLOWED_ORIGIN}
  frontend:
    url: ${FRONTEND_URL}
  # Mail configuration - credentials from environment variables
  mail:
    host: ${MAIL_HOST}
    port: ${MAIL_PORT}
    username: ${MAIL_USERNAME}
    password: ${MAIL_PASSWORD}
  auth:
    # Token lifetime in minutes (1 hour) - sliding session extends this on each API call
    token-lifetime-in-minutes: ${JWT_TOKEN_LIFETIME:60}
    # Secret key - MUST be set via environment variable in production
    secret-key-base: ${JWT_SECRET_KEY}

---
# Profile: mysqldb
spring:
  config:
    activate:
      on-profile: mysqldb
  jpa:
    database-platform: org.hibernate.dialect.MySQLDialect
